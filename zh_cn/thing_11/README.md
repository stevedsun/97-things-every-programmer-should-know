# 以业务领域语言编写代码

假设你在两个代码库中遇到以下代码：

```
lessCopy codeif (portfolioIdsByTraderId.get(trader.getId())
  .containsKey(portfolio.getId())) {...}
```

你摇头疑惑这段代码是用来干什么的。它似乎是从一个交易员对象获取一个ID，然后使用它从一个看似是map-of-maps的映射中获取一个映射，并查看另一个来自投资组合对象的ID是否存在于内部映射中。你又看了一眼`portfolioIdsByTraderId`的声明：

```
pythonCopy code
Map<int, Map<int, int>> portfolioIdsByTraderId;
```

逐渐地，你意识到它可能与一个交易员是否可以访问特定的投资组合有关。当然，你会发现相同的查找片段，或者更可能是一个类似但微妙不同的代码片段，当需要关心一个交易员是否可以访问特定的投资组合时。

在另一个代码库中，你遇到了这个：

```
lessCopy code
if (trader.canView(portfolio)) {...}
```

没有什么难度。你不需要知道一个交易员如何知道这个，也许里面有一个map-of-maps。但这是交易员的事情，不是你的。

现在，你更愿意在哪一个代码库中工作？

曾经，我们只有非常基本的数据结构：位、字节和字符（实际上只是字节，但我们会假装它们是字母和标点符号）。十进制数有点棘手，因为我们的十进制数字在二进制中不太好用，所以我们有几种浮点类型。然后是数组和字符串（实际上只是不同的数组）。然后是栈、队列、哈希表、链表、跳表和其他许多在现实世界中不存在的令人兴奋的数据结构。 "计算机科学" 是关于花费大量精力将现实世界映射到我们的限制性数据结构中。真正的专家甚至能记住他们是如何做到的。

然后，我们得到了用户定义的类型！好吧，这并不是新闻，但确实改变了游戏规则。如果你的业务领域中包含类似交易员和投资组合的概念，你可以使用名为Trader和Portfolio的类型来建模它们。但是，更重要的是，你也可以使用领域术语来建模它们之间的关系。

如果你不使用领域术语编码，你就会创造一个隐含的（读：秘密）理解，即这里的这个int意味着用于标识交易员的方式，而“那边” 的int则意味着用于标识投资组合的方式。最好不要把它们混淆！如果你用一段算法片段（例如，一组键的映射关系）来表示一个业务概念（“一些交易员不允许查看某些投资组合——这是非法的”），那么你就没有为审计和合规人员提供任何帮助。

下一个程序员可能不知道这个秘密，为什么不让它显式化呢？使用一个键作为另一个键的查找，并执行一个存在性检查并不是非常明显的。有人怎么可能意识到这是实施防止利益冲突的业务规则的地方呢？

在代码中明确领域概念意味着其他程序员可以更容易地了解代码的意图，而不是试图把算法“改装”成他们对领域的理解。这也意味着当领域模型发展（随着对领域的理解不断加深），你将处于良好的代码演化位置。加上良好的封装，规则很可能只存在于一个地方，你可以在不让任何依赖代码知情的情况下进行更改。

几个月后，来工作的程序员会感谢你。几个月后，来工作的程序员可能是你自己。

By [Dan North](http://programmer.97things.oreilly.com/wiki/index.php/Dan_North)